import{ethers as e}from"ethers";var t,n=[{inputs:[{internalType:"address",name:"_lpContract",type:"address"},{internalType:"address",name:"_initialOwner",type:"address"},{internalType:"address",name:"_governance",type:"address"},{internalType:"address",name:"_bqBTC",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"CoverNotAvailable",type:"error"},{inputs:[],name:"InsufficientPoolBalance",type:"error"},{inputs:[],name:"InvalidAmount",type:"error"},{inputs:[],name:"InvalidCoverDuration",type:"error"},{inputs:[],name:"LpNotActive",type:"error"},{inputs:[],name:"NameAlreadyExists",type:"error"},{inputs:[],name:"NoClaimableReward",type:"error"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{inputs:[],name:"ReentrancyGuardReentrantCall",type:"error"},{inputs:[],name:"UnsupportedCoverType",type:"error"},{inputs:[],name:"UserHaveAlreadyPurchasedCover",type:"error"},{inputs:[],name:"WrongPool",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"coverId",type:"uint256"},{indexed:!1,internalType:"string",name:"name",type:"string"},{indexed:!1,internalType:"enum CoverLib.RiskType",name:"riskType",type:"uint8"}],name:"CoverCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"coverValue",type:"uint256"},{indexed:!1,internalType:"uint256",name:"coverFee",type:"uint256"},{indexed:!1,internalType:"enum CoverLib.RiskType",name:"riskType",type:"uint8"}],name:"CoverPurchased",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"coverId",type:"uint256"},{indexed:!1,internalType:"string",name:"coverName",type:"string"},{indexed:!1,internalType:"enum CoverLib.RiskType",name:"riskType",type:"uint8"}],name:"CoverUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"poolId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"PayoutClaimed",type:"event"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"NextLpClaimTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"bqBTC",outputs:[{internalType:"contract IbqBTC",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"bqBTCAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_poolId",type:"uint256"}],name:"claimPayoutForLP",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"coverCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"coverExists",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"coverFeeBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"coverIds",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"covers",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"coverName",type:"string"},{internalType:"enum CoverLib.RiskType",name:"riskType",type:"uint8"},{internalType:"string",name:"chains",type:"string"},{internalType:"uint256",name:"capacity",type:"uint256"},{internalType:"uint256",name:"cost",type:"uint256"},{internalType:"uint256",name:"capacityAmount",type:"uint256"},{internalType:"uint256",name:"coverValues",type:"uint256"},{internalType:"uint256",name:"maxAmount",type:"uint256"},{internalType:"uint256",name:"poolId",type:"uint256"},{internalType:"string",name:"CID",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"coverId",type:"uint256"},{internalType:"string",name:"_cid",type:"string"},{internalType:"enum CoverLib.RiskType",name:"_riskType",type:"uint8"},{internalType:"string",name:"_coverName",type:"string"},{internalType:"string",name:"_chains",type:"string"},{internalType:"uint256",name:"_capacity",type:"uint256"},{internalType:"uint256",name:"_cost",type:"uint256"},{internalType:"uint256",name:"_poolId",type:"uint256"}],name:"createCover",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_user",type:"address"}],name:"deleteExpiredUserCovers",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getAllAvailableCovers",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"coverName",type:"string"},{internalType:"enum CoverLib.RiskType",name:"riskType",type:"uint8"},{internalType:"string",name:"chains",type:"string"},{internalType:"uint256",name:"capacity",type:"uint256"},{internalType:"uint256",name:"cost",type:"uint256"},{internalType:"uint256",name:"capacityAmount",type:"uint256"},{internalType:"uint256",name:"coverValues",type:"uint256"},{internalType:"uint256",name:"maxAmount",type:"uint256"},{internalType:"uint256",name:"poolId",type:"uint256"},{internalType:"string",name:"CID",type:"string"}],internalType:"struct CoverLib.Cover[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAllParticipants",outputs:[{internalType:"address[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getAllUserCovers",outputs:[{components:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"coverId",type:"uint256"},{internalType:"enum CoverLib.RiskType",name:"riskType",type:"uint8"},{internalType:"string",name:"coverName",type:"string"},{internalType:"uint256",name:"coverValue",type:"uint256"},{internalType:"uint256",name:"claimPaid",type:"uint256"},{internalType:"uint256",name:"coverPeriod",type:"uint256"},{internalType:"uint256",name:"endDay",type:"uint256"},{internalType:"bool",name:"isActive",type:"bool"}],internalType:"struct CoverLib.GenericCoverInfo[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCoverFeeBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_coverId",type:"uint256"}],name:"getCoverInfo",outputs:[{components:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"string",name:"coverName",type:"string"},{internalType:"enum CoverLib.RiskType",name:"riskType",type:"uint8"},{internalType:"string",name:"chains",type:"string"},{internalType:"uint256",name:"capacity",type:"uint256"},{internalType:"uint256",name:"cost",type:"uint256"},{internalType:"uint256",name:"capacityAmount",type:"uint256"},{internalType:"uint256",name:"coverValues",type:"uint256"},{internalType:"uint256",name:"maxAmount",type:"uint256"},{internalType:"uint256",name:"poolId",type:"uint256"},{internalType:"string",name:"CID",type:"string"}],internalType:"struct CoverLib.Cover",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"_poolId",type:"uint256"}],name:"getDepositClaimableDays",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"_poolId",type:"uint256"}],name:"getLastClaimTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"_coverId",type:"uint256"}],name:"getUserCoverInfo",outputs:[{components:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"coverId",type:"uint256"},{internalType:"enum CoverLib.RiskType",name:"riskType",type:"uint8"},{internalType:"string",name:"coverName",type:"string"},{internalType:"uint256",name:"coverValue",type:"uint256"},{internalType:"uint256",name:"claimPaid",type:"uint256"},{internalType:"uint256",name:"coverPeriod",type:"uint256"},{internalType:"uint256",name:"endDay",type:"uint256"},{internalType:"bool",name:"isActive",type:"bool"}],internalType:"struct CoverLib.GenericCoverInfo",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserParticipation",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"governance",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"lpAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"lpContract",outputs:[{internalType:"contract ILP",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"participants",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"participation",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_coverId",type:"uint256"},{internalType:"uint256",name:"_coverValue",type:"uint256"},{internalType:"uint256",name:"_coverPeriod",type:"uint256"},{internalType:"uint256",name:"_coverFee",type:"uint256"}],name:"purchaseCover",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_coverId",type:"uint256"},{internalType:"string",name:"_coverName",type:"string"},{internalType:"enum CoverLib.RiskType",name:"_riskType",type:"uint8"},{internalType:"string",name:"_cid",type:"string"},{internalType:"string",name:"_chains",type:"string"},{internalType:"uint256",name:"_capacity",type:"uint256"},{internalType:"uint256",name:"_cost",type:"uint256"},{internalType:"uint256",name:"_poolId",type:"uint256"}],name:"updateCover",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_coverId",type:"uint256"}],name:"updateMaxAmount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"_coverId",type:"uint256"},{internalType:"uint256",name:"_claimPaid",type:"uint256"}],name:"updateUserCoverValue",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"userCovers",outputs:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"coverId",type:"uint256"},{internalType:"enum CoverLib.RiskType",name:"riskType",type:"uint8"},{internalType:"string",name:"coverName",type:"string"},{internalType:"uint256",name:"coverValue",type:"uint256"},{internalType:"uint256",name:"claimPaid",type:"uint256"},{internalType:"uint256",name:"coverPeriod",type:"uint256"},{internalType:"uint256",name:"endDay",type:"uint256"},{internalType:"bool",name:"isActive",type:"bool"}],stateMutability:"view",type:"function"}];!function(e){e[e.COREDAO=1115]="COREDAO",e[e.BEVM=11503]="BEVM",e[e.MERLIN=686868]="MERLIN"}(t||(t={}));const i=["0xEbC11e13375DEc4c43118b8f530b0dc31fF9e4a7","0x9552c86e01B431066AddE3096DFB482CbD82A185","0x180e565b81422e9F38e8e852Cd7CA3CD50AB8777"];async function a(){if(!window.ethereum)throw new Error("MetaMask is not installed");const t=new e.BrowserProvider(window.ethereum);return(await t.send("eth_accounts",[])).length>0||await t.send("eth_requestAccounts",[]),await t.getSigner()}async function r(t,i){const r=await a(),p=new e.Contract(i,n,r),u=await p.getCoverInfo(t);return{id:Number(u[0]),name:u[1],risk:Number(u[2]),chains:u[3],capacity:Number(u[4]),cost:Number(u[5]),capacityAmount:Number(u[6]),coverValues:Number(u[7]),maxAmount:Number(u[8]),poolId:Number(u[9]),cid:u[10]}}async function p(t,n,i,a){try{const p=await r(t,a);if(!p||!p.cost)throw new Error("Invalid cover info or cost");const u=p.cost/100*n*(i/365);return{numericFee:u,weiValue:e.parseEther(u.toFixed(18))}}catch(e){throw console.error("Error calculating cover fee:",e),e}}class u{constructor(e,t){this.protocolName=void 0,this.coverId=void 0,this.protocolName=e,this.coverId=t}displayConfig(){console.log(`Client Config: ${this.protocolName}, Cover ID: ${this.coverId}`)}async coverInfo(e){return await r(this.coverId,e)}async userPurchaseCover(t,i,r){return await async function(t,i,r,u){const y=await a(),s=new e.Contract(u,n,y),{weiValue:o}=await p(t,i,r,u);console.log(o);const l=e.parseEther(i.toString());try{const e=await s.purchaseCover(t,l,r,o);return(await e.wait()).hash}catch(e){throw e}}(this.coverId,t,i,r)}async calculateUserCoverFee(e,t,n){const{numericFee:i}=await p(this.coverId,e,t,n);return i}getCoverAddress(e){return(e=>{switch(e){case t.COREDAO:return i[0];case t.BEVM:return i[1];case t.MERLIN:return i[2];default:return""}})(e)}}export{u as default};
